<!doctype html>
<html xmlns:th="https://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<!--
  given a map: Map<Student, List<RequirementAndInstance>>
-->
<th:block th:fragment="student-accordion(map, docuMap)">
<!--    TODO: used for testing -->
<!--    <div class="container-md" th:each="docGuid: ${docuMap.keySet().iterator()}">-->
<!--        <p th:text="${docGuid}"></p>-->
<!--    </div>-->
    <div class="accordion">
        <div class="accordion-item" th:each="student: ${map.keySet().iterator()}">
            <h2 class="accordion-header" th:id="${student.getUid() + '-heading'}">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        th:data-bs-target="${'#' + student.getUid() + '-collapse'}" aria-expanded="true"
                        th:aria-controls="${student.getUid() + '-collapse'}">
                    <h5 th:text="${student.getFirst_name() + ' ' + student.getLast_name()}"></h5>
                </button>
            </h2>
            <div th:id="${student.getUid() + '-collapse'}" class="accordion-collapse collapse"
                 th:aria-labelledby="${student.getUid() + '-heading'}" data-bs-parent="student-accordion">
                <div class="accordion-body" th:each="reqAndInstance: ${map.get(student)}">
                    <h3 th:text="${reqAndInstance.getRequirement().getTitle()}"></h3>
                    <th:block th:switch="${reqAndInstance.getRequirementInstance().getStatus()}">
                        <h4 th:case="'Complete'" class="text-bg-success">Status: Complete</h4>
                        <h4 th:case="'In Progress'" class="text-bg-primary">Status: In Progress</h4>
                        <h4 th:case="'Incomplete'" class="text-bg-secondary">Status: Incomplete</h4>
                    </th:block>
                    <p th:text="${reqAndInstance.getRequirement().getDescription()}"></p>
                    <!--TODO: implement buttons-->
                    <th:block th:unless="${reqAndInstance.getRequirementInstance().getDocGUID() == null}">
                        <p>I am not a null requirement document</p>
                        <p th:text="${reqAndInstance.getRequirementInstance().getDocGUID()}"></p>
                        <a th:href="${'/get-document/' + reqAndInstance.getRequirementInstance().getDocGUID() + '/' + docuMap.get(reqAndInstance.getRequirementInstance().getDocGUID()).getFileExtension()}">Download</a>
                        <p th:text="${docuMap.get(reqAndInstance.getRequirementInstance().getDocGUID()).getFileExtension()}"></p>
<!--                        &lt;!&ndash; TODO: fix this, there might not be a need to be a form for everything &ndash;&gt;-->
<!--                        <form th:action="${'/get-document/' + reqAndInstance.getRequirementInstance().getDocGUID() + '/' + docuMap.get(reqAndInstance.getRequirementInstance().getDocGUID()).getFileExtension()}" method="post"><input type="hidden" name="guid" th:value="${reqAndInstance.getRequirementInstance().getDocGUID()}">-->
<!--                            &lt;!&ndash; TODO: not sure why th:value is that &ndash;&gt;-->
<!--                            <input type="hidden" name="fileExtension"-->
<!--                                   th:value="${docuMap.get(reqAndInstance.getRequirementInstance().getDocGUID()).getFileExtension()}">-->
<!--                            <button type="submit">Download</button>-->
<!--                        </form>-->
<!--                        <button disabled>Approve</button>-->
<!--                        <button disabled>Deny</button>-->
                    </th:block>
                </div>
            </div>
        </div>
    </div>
</th:block>
</body>
</html>